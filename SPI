
//master code

#include <SPI.h>

void setup() {
  Serial.begin(9600);
  SPI.begin();                // Start SPI as master
  pinMode(SS, OUTPUT);        // Slave Select pin as output
  digitalWrite(SS, HIGH);     // Ensure slave not selected
}

void loop() {
  char data = 'A';            // Data to send
  digitalWrite(SS, LOW);      // Select slave
  SPI.transfer(data);         // Send data byte
  digitalWrite(SS, HIGH);     // Deselect slave
  Serial.print("Sent: ");
  Serial.println(data);
  delay(1000);
}

//slave code
#include <SPI.h>

volatile boolean received = false;
volatile byte receivedData;

void setup() {
  Serial.begin(9600);
  pinMode(MISO, OUTPUT);      // Set MISO as output
  SPCR |= _BV(SPE);           // Enable SPI in slave mode
  SPI.attachInterrupt();      // Enable SPI interrupt
}

ISR(SPI_STC_vect) {           // SPI interrupt routine
  receivedData = SPDR;        // Read data register
  received = true;            // Flag new data
}

void loop() {
  if (received) {
    Serial.print("Received: ");
    Serial.println((char)receivedData);
    received = false;
  }
}
// 10 11 12 13
